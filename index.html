<!DOCTYPE html>
<html lang="es">
<head>

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Formación CAB</title>
  <style>
      body {
        font-family: Arial, sans-serif;
        background: #e9ecef;
        background-image: url('AFA.jpg');
        background-size: cover;
        background-repeat: no-repeat;
        background-position: center;

        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 10px;

     }

      
      #field {
        position: relative;
        background: url('1137.jpg') center/cover no-repeat;
        width: 360px;
        height: 540px;
        border: 3px solid #fff;
        border-radius: 10px;
        margin: 10px 0;
        page-break-inside: avoid;
      }

      .player-container {
        position: absolute;
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 60px;
      cursor: move;
    }

    .player {
      width: 60px;
      height: 70px;
      background: url('camiseta.png') center/contain no-repeat;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-end;
    }

    .player-number {
      font-weight: bold;
      color: black;
      font-size: 14px;
      margin-bottom: 30px; /* sube el número unos píxeles */
    }


    .player-name {
      font-size: 10px;
      font-weight: bold;
      color: black;
      background: rgba(255,255,255,0.7);
      padding: 1px 3px;
      border-radius: 3px;
      margin-top: 2px;
      text-align: center;
      width: 100%;
    }

    #bench {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        justify-content: center;
        margin-top: 10px;
        background: rgba(255, 255, 255, 0.8);
        border: 2px dashed #666;
        border-radius: 8px;
        padding: 10px;
        width: 450px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    #bench .player-container {
        position: relative; /* que no interfiera con el campo */
        flex: 0 0 auto;      /* evita que se estiren */
    }

    button, input, select {
      margin: 5px;
      padding: 6px 10px;
      font-size: 14px;
    }
    
    #banco-tecnico {
       margin-top: 1rem;
       padding: 1rem;
       background-color: #f2f2f2;
       border-radius: 12px;
       max-width: 300px;
       font-family: sans-serif;
     }


    @media print {
      form, select, button, #loadFile {
        display: none !important;
      }
        
      body {
        background-image: url('AFA.jpg');
        background-size: cover;
        background-repeat: no-repeat;
        background-position: center;
        -webkit-print-color-adjust: exact; /* Importante para que el fondo se imprima */
        print-color-adjust: exact;
        }

  

   
      .event-form {
            display: none !important;
        }
     
      #field {
            background: url('1137.jpg') center/cover no-repeat !important;
        }

      .player {
        background: url('camiseta.png') center/contain no-repeat !important;
        }

      .player-container {
        page-break-inside: avoid;
        }

    }

    #selector-categoria {
        min-width: 200px;
        padding: 10px;
        background-color: #f5f5f5;
        border-radius: 8px;
   }
  </style>
</head>
<body>

<h2></h2>

<div id="eventData"><h3></h3></div>

<div class="event-form">
    <label> 
        <select id="categoriaSelect">
            <option value="">Seleccione Categoría</option>
            <option value="Reserva">Reserva</option>
            <option value="Cuarta">Cuarta</option>
            <option value="Quinta">Quinta</option>
            <option value="Sexta">Sexta</option>
            <option value="Septima">Septima</option>
            <option value="Octava">Octava</option>
            <option value="Novena">Novena</option>
        </select>
    </label>
    
    <label>
        <select id="NFecha">
            <option value="">Seleccione N° Fecha</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>    
        </select>
        <label><input type="date" id="fechaEncuentro"></label>
        <select id="rivalSelect">
            <option value="">Seleccione Rival</option>
            <option value="Aldosivi">Aldosivi</option>
            <option value="Argentinos">Argentinos</option>
            <option value="Atl Tucuman">Atl Tucuman</option>
            <option value="Banfield">Banfield</option>
            <option value="Barracas Central">Barracas Central</option>
            <option value="Boca Juniors">Boca Juniors</option>
            <option value="Central Cba (SdE)">Central Cba (SdE)</option>
            <option value="Colon">Colon</option>
            <option value="Def y Justicia">Def y Justicia</option>
            <option value="Estudiantes (LP)">Estudiantes (LP)</option>
            <option value="Ferro">Ferro</option>
            <option value="Gimnasia (LP)">Gimnasia (LP)</option>
            <option value="Godoy Cruz">Godoy Cruz</option>
            <option value="Huracan">Huracan</option>
            <option value="Ind Rivadavia">Ind Rivadavia</option>
            <option value="Independiente">Independiente</option>
            <option value="Indepte Mza">Indepte Mza</option>
            <option value="Instituto">Instituto</option>
            <option value="Lanus">Lanus</option>
            <option value="Newells">Newells</option>
            <option value="Platense">Platense</option>
            <option value="Racing Club">Racing Club</option>
            <option value="Riestra">Riestra</option>
            <option value="River Plate">River Plate</option>
            <option value="Rosario Central">Rosario Central</option>
            <option value="San Lorenzo">San Lorenzo</option>
            <option value="Sarmiento (J)">Sarmiento (J)</option>
            <option value="Talleres (C)">Talleres (C)</option>
            <option value="Tigre">Tigre</option>
            <option value="Union">Union</option>
            <option value="Velez">Velez</option>
        </select>
    </label>
    <label> 
        <select id="formationSelect1">
            <option value="">Seleccionar Formación</option>
            <option value="4-4-2">4-4-2</option>
            <option value="4-4-1-1">4-4-1-1</option>
            <option value="4-3-1-2">4-3-1-2</option>
            <option value="4-1-3-2">4-1-3-2</option>
            <option value="4-3-3">4-3-3</option>
            <option value="4-1-4-1">4-1-4-1</option>
            <option value="4-2-3-1">4-2-3-1</option>
            <option value="3-4-1-2">3-4-1-2</option>
            <option value="3-4-3">3-4-3</option>
            <option value="3-5-2">3-5-2</option>
            <option value="5-3-2">5-3-2</option>
        </select>
    </label>

    <button type="button" id="guardarEvento">Guardar Evento</button>
</div>





<script>
    const formationSelect1 = document.getElementById('formationSelect1');
    const guardarEvento = document.getElementById('guardarEvento');

    const categoriaSelect = document.getElementById('categoriaSelect');
    const dtInput = document.getElementById('dt');
    const pfInput = document.getElementById('pf');
    const acInput = document.getElementById('ac');



    guardarEvento.addEventListener("click", function() {
        const categoria = categoriaSelect.value;
        
        const NFecha = document.getElementById("NFecha").value;
        const rival = document.getElementById("rivalSelect").value;
        const fechaEncuentroRaw = document.getElementById("fechaEncuentro").value;
        const formacion = formationSelect.value;

        let fechaFormateada = "";
        if (fechaEncuentroRaw) {
        const partes = fechaEncuentroRaw.split("-");
        fechaFormateada = `${partes[2]}/${partes[1]}/${partes[0]}`;
        }  

        const datosHTML = `
        <div style="display: flex; justify-content: space-between; margin-top: 30px; gap: 20px;">
          <div style="text-align: left;font-weight: bold; margin-top: 40px;">
           <p>Fecha N°: ${NFecha}</p>
           </div>
          <div style="text-align: left;font-weight: bold; margin-top: 40px;"> 
           <p>Día: ${fechaFormateada}</p>
           </div>
          <div style="text-align: left;font-weight: bold; margin-top: 40px;">  
           <p>Categoría: ${categoria}</p>
           </div>
          <div style="text-align: left;font-weight: bold; margin-top: 40px;">   
           <p>Rival: ${rival}</p>
           </div>

        </div>
`;

        document.getElementById("eventData").innerHTML = datosHTML;
    });


 
</script>



<form id="playerForm">
  <h3 style="text-align: center;">Formación del Partido</h3>
  <input type="text" id="name" placeholder="Nombre" required />
  <input type="number" id="number" placeholder="N°" required />
  <select id="position">
    <option value="titular">Titular</option>
    <option value="suplente">Suplente</option>
  </select>
  <button type="submit">Agregar</button>
  <button onclick="resetPositions()">Resetear Posiciones</button>
</form>

<div>
  <select id="formationSelect">
    <option value="4-4-2">4-4-2</option>
    <option value="4-3-3">4-3-3</option>
    <option value="3-5-2">3-5-2</option>
  </select>
  <button onclick="applyFormation()">Aplicar Formación</button>
  <button onclick="saveFormation()">Guardar</button>
  <button onclick="loadFormation()">Cargar</button>
  <button onclick="window.print()">Imprimir</button>
  <button onclick="sendWhatsApp()">WhatsApp</button>
  <input type="file" id="loadFile" style="display:none" />
</div>



<div style="display: flex; gap: 60px; align-items: flex-start;">
  
  <div id="field"; style="margin-top: 80px;"></div>
  

  
  <!-- Banco técnico -->
  <div id="banco-tecnico"; style="margin-top: 80px;">
      <!-- Selector de categoría -->
   <select id="categoria" onchange="actualizarCuerpoTecnico()">
    <option value="">Cuerpo Técnico</option>
    <option value="reserva">Reserva</option>
    <option value="cuarta">Cuarta</option>
    <option value="quinta">Quinta</option>
    <option value="sexta">Sexta</option>
    <option value="septima">Séptima</option>
    <option value="octava">Octava</option>
    <option value="novena">Novena</option>
  </select>

    <label><h3>Cuerpo Técnico</h3></label>
    <p><strong>DT:</strong> <span id="dt"></span></p>
    <p><strong>AC:</strong> <span id="ac"></span></p>
    <p><strong>PF:</strong> <span id="pf"></span></p>
  </div>
</div>

<h3>Suplentes</h3>
<div id="bench"></div>

<script>
  const field = document.getElementById("field");
  const bench = document.getElementById("bench");
  const form = document.getElementById("playerForm");
  const formationSelect = document.getElementById("formationSelect");
  const loadFile = document.getElementById("loadFile");

  let players = [];

form.addEventListener("submit", function (e) {
  e.preventDefault();
  const name = document.getElementById("name").value;
  const number = document.getElementById("number").value;
  const position = document.getElementById("position").value;

  if (position === "titular") {
    const titulares = players.filter(p => p.position === "titular");
    if (titulares.length >= 11) {
      alert("Solo se permiten 11 jugadores titulares en cancha.");
      return;
    }
  }
  
  if (position === "suplente") {
  const suplentes = players.filter(p => p.position === "suplente");
  if (suplentes.length >= 6) {
    alert("Solo se permiten 6 suplentes.");
    return;
  }
  }

  const playerData = {
    name,
    number,
    x: 0,
    y: 0,
    position
  };

const alreadyExists = players.some(p => p.number === number);
if (alreadyExists) {
  alert("Ya hay un jugador con ese número de camiseta.");
  return;
}

  players.push(playerData);
  renderPlayers();
  form.reset();
});


  function renderPlayers() {
    field.innerHTML = "";
    bench.innerHTML = "";
    
    players.forEach((player) => {
      const container = document.createElement("div");
      container.className = "player-container";

      const camiseta = document.createElement("div");
      camiseta.className = "player";
      const number = document.createElement("div");
      number.className = "player-number";
      number.textContent = player.number;
      camiseta.appendChild(number);

      const name = document.createElement("div");
      name.className = "player-name";
      name.contentEditable = true;
      name.textContent = player.name;
      name.addEventListener("input", () => {
        player.name = name.textContent;
      });

      container.appendChild(camiseta);
      container.appendChild(name);

      const deleteBtn = document.createElement("button");
      deleteBtn.textContent = "";
      deleteBtn.style.marginRight = "0px";
      deleteBtn.onclick = () => {
      players = players.filter(p => p !== player);
    renderPlayers();
};
container.appendChild(deleteBtn);
      if (player.position === 'titular') {
        container.style.left = player.x + "px";
        container.style.top = player.y + "px";
        makeDraggable(container, player);
        field.appendChild(container);
      } else {
        bench.appendChild(container);
      }
    });
  }

  function makeDraggable(el, playerData) {
    let isDragging = false, offsetX, offsetY;

    el.addEventListener("mousedown", (e) => {
      isDragging = true;
      offsetX = e.offsetX;
      offsetY = e.offsetY;
    });

    document.addEventListener("mousemove", (e) => {
      if (isDragging) {
        const rect = field.getBoundingClientRect();
        let x = e.clientX - rect.left - offsetX;
        let y = e.clientY - rect.top - offsetY;

        x = Math.max(0, Math.min(x, rect.width - el.offsetWidth));
        y = Math.max(0, Math.min(y, rect.height - el.offsetHeight));

        el.style.left = x + "px";
        el.style.top = y + "px";
        playerData.x = x;
        playerData.y = y;
      }
    });

    document.addEventListener("mouseup", () => {
      isDragging = false;
    });
  }

  function applyFormation() {
  const formation = formationSelect.value;
  const titulares = players.filter(p => p.position === 'titular');

  if (titulares.length === 0) return;


  const [def, mid, att] = formation.split("-").map(n => parseInt(n));
  const total = 1 + def + mid + att;

  if (titulares.length < total) {
    alert(`Faltan jugadores para completar la formación ${formation} + arquero.`);
    return;
  }

  // Distribución de líneas (de abajo hacia arriba)
  const lines = [
    { count: 1, y: 440 },         // Arquero
    { count: def, y: 360 },       // Defensores
    { count: mid, y: 220 },       // Mediocampistas
    { count: att, y: 80 }        // Delanteros
  ];

  let i = 0;
  lines.forEach(line => {
    const spacing = 360 / (line.count + 1);
    for (let j = 0; j < line.count && i < titulares.length; j++, i++) {
      const player = titulares[i];
      player.x = spacing * (j + 1) - 30;
      player.y = line.y;
    }
  });

  renderPlayers();
}


  function saveFormation() {
    const blob = new Blob([JSON.stringify(players)], { type: "application/json" });
    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = "formacion.json";
    a.click();
  }

  function loadFormation() {
    loadFile.click();
  }

  loadFile.addEventListener("change", function (e) {
    const file = e.target.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = function (e) {
      players = JSON.parse(e.target.result);
      renderPlayers();
    };
    reader.readAsText(file);
  });

  function sendWhatsApp() {
    let text = "*Formación CAB*\n\n*TITULARES:*\n";
    const titulares = players.filter(p => p.position === "titular");
    titulares.forEach(p => {
      text += `• ${p.number} - ${p.name}\n`;
    });

    text += "\n*SUPLENTES:*\n";
    const suplentes = players.filter(p => p.position === "suplente");
    suplentes.forEach(p => {
      text += `• ${p.number} - ${p.name}\n`;
    });

    const url = "https://wa.me/?text=" + encodeURIComponent(text);
    window.open(url, "_blank");
  }
  function resetPositions() {
  players.forEach(p => {
    if (p.position === 'titular') {
      p.x = 0;
      p.y = 0;
    }
  });
  renderPlayers();
 }
 
  players[index].position = newStatus;
  renderPlayers();

</script>

<script>
  const cuerpoTecnicoPorCategoria = {
    reserva: { dt: "Carlos Gómez", ac: "Luis Pérez", pf: "Andrés Ramírez" },
    cuarta: { dt: "Martín Ruiz", ac: "Javier Acosta", pf: "Diego López" },
    quinta: { dt: "Sebastián Torres", ac: "Emilio Díaz", pf: "Lucas Fernández" },
    sexta: { dt: "Fernando Sosa", ac: "Pablo Molina", pf: "Maxi Cabrera" },
    septima: { dt: "Gabriel Gómez", ac: "Oscar Valle", pf: "Matías Duarte" },
    octava: { dt: "Rubén Silva", ac: "Nicolás Ríos", pf: "Ramiro Alonso" },
    novena: { dt: "Alejandro Varela", ac: "Iván Salas", pf: "Franco Medina" },
  };

  function actualizarCuerpoTecnico() {
    const categoria = document.getElementById("categoria").value;
    const tecnico = cuerpoTecnicoPorCategoria[categoria];

    if (tecnico) {
      document.getElementById("dt").textContent = tecnico.dt;
      document.getElementById("ac").textContent = tecnico.ac;
      document.getElementById("pf").textContent = tecnico.pf;
    } else {
      document.getElementById("dt").textContent = "";
      document.getElementById("ac").textContent = "";
      document.getElementById("pf").textContent = "";
    }
  }
</script>


</body>
</html>
